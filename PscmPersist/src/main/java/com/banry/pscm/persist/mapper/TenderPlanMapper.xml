<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.banry.pscm.persist.dao.TenderPlanMapper">
  <resultMap id="BaseResultMap" type="com.banry.pscm.service.tender.TenderPlan">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    <id column="tender_plan_code" jdbcType="VARCHAR" property="tenderPlanCode" />
    <result column="work_item_name" jdbcType="VARCHAR" property="workItemName" />
    <result column="tender_plan_date" jdbcType="DATE" property="tenderPlanDate" />
    <result column="latest_marchin_date" jdbcType="DATE" property="latestMarchinDate" />
    <result column="plan_supplier_number" jdbcType="INTEGER" property="planSupplierNumber" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBizType" type="com.banry.pscm.service.tender.TenderPlan">
  	<association property="bizType" javaType="com.banry.pscm.service.util.EnumVar">
    	<id column="bt_enum_value" jdbcType="INTEGER" property="enumValue" />
    	<result column="bt_enum_value_name" jdbcType="VARCHAR" property="enumValueName" />
    </association>
    <association property="tenderWay" javaType="com.banry.pscm.service.util.EnumVar">
    	<id column="tw_enum_value" jdbcType="INTEGER" property="enumValue" />
    	<result column="tw_enum_value_name" jdbcType="VARCHAR" property="enumValueName" />
    </association>
    <association property="status" javaType="com.banry.pscm.service.util.EnumVar">
    	<id column="s_enum_value" jdbcType="INTEGER" property="enumValue" />
    	<result column="s_enum_value_name" jdbcType="VARCHAR" property="enumValueName" />
    </association>
  </resultMap>
  <resultMap extends="ResultMapWithBizType" id="ResultMapWithBLOBs" type="com.banry.pscm.service.tender.TenderPlanWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    <result column="main_contents" jdbcType="LONGVARCHAR" property="mainContents" />
    <result column="scope_workload" jdbcType="LONGVARCHAR" property="scopeWorkload" />
    <result column="requirements" jdbcType="LONGVARCHAR" property="requirements" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    a.tender_plan_code, a.biz_type, a.work_item_name, a.tender_plan_date, a.latest_marchin_date, 
    a.tender_way, a.plan_supplier_number, a.status, a.remark
  </sql>
  <sql id="Biz_Type_Column_List">
    bt.enum_value bt_enum_value, bt.enum_value_name bt_enum_value_name
  </sql>
  <sql id="Tender_Way_Column_List">
    tw.enum_value tw_enum_value, tw.enum_value_name tw_enum_value_name
  </sql>
  <sql id="Status_Column_List">
    s.enum_value s_enum_value, s.enum_value_name s_enum_value_name
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    main_contents, scope_workload, requirements
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.util.Map" resultMap="ResultMapWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    ,
    <include refid="Biz_Type_Column_List" />
    ,
    <include refid="Tender_Way_Column_List" />
    ,
    <include refid="Status_Column_List" />
    from tender_plan a left join tenant_${parentTenantAccount}.enum_var bt on a.biz_type = bt.enum_value and bt.enum_name = 'BizType'
    left join tenant_${parentTenantAccount}.enum_var tw on a.tender_way = tw.enum_value and tw.enum_name = 'TenderWay'
    left join tenant_${parentTenantAccount}.enum_var s on a.status = s.enum_value and s.enum_name = 'TenderPlanStatus'
    where tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}
  </select>
  <select id="findAll" parameterType="java.lang.String" resultMap="ResultMapWithBLOBs">
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    ,
    <include refid="Biz_Type_Column_List" />
    ,
    <include refid="Tender_Way_Column_List" />
    ,
    <include refid="Status_Column_List" />
    from tender_plan a left join tenant_${value}.enum_var bt on a.biz_type = bt.enum_value and bt.enum_name = 'BizType'
    left join tenant_${value}.enum_var tw on a.tender_way = tw.enum_value and tw.enum_name = 'TenderWay'
    left join tenant_${value}.enum_var s on a.status = s.enum_value and s.enum_name = 'TenderPlanStatus'
  </select>
  <select id="findTenderPlanRelease" parameterType="int" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    <![CDATA[
    from tender_plan a
    where a.status = #{value,jdbcType=INTEGER} and exists (
    	select 1 
    	from release_target b
    	where a.tender_plan_code = b.tender_plan_code
    	and b.address = '/tenderPlan/getTotalReleaseTenderPlan'
    	and b.start_date <= curdate()
    	and b.end_date >= curdate()
    )
    ]]>
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    delete from tender_plan
    where tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.banry.pscm.service.tender.TenderPlanWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    insert into tender_plan (tender_plan_code, biz_type, work_item_name, 
      tender_plan_date, latest_marchin_date, tender_way, 
      plan_supplier_number, status, remark, 
      main_contents, scope_workload, requirements
      )
    values (#{tenderPlanCode,jdbcType=VARCHAR}, #{bizType.enumValue,jdbcType=INTEGER}, #{workItemName,jdbcType=VARCHAR}, 
      #{tenderPlanDate,jdbcType=DATE}, #{latestMarchinDate,jdbcType=DATE}, #{tenderWay.enumValue,jdbcType=INTEGER}, 
      #{planSupplierNumber,jdbcType=INTEGER}, #{status.enumValue,jdbcType=INTEGER}, #{remark,jdbcType=VARCHAR}, 
      #{mainContents,jdbcType=LONGVARCHAR}, #{scopeWorkload,jdbcType=LONGVARCHAR}, #{requirements,jdbcType=LONGVARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.banry.pscm.service.tender.TenderPlanWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    insert into tender_plan
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="tenderPlanCode != null">
        tender_plan_code,
      </if>
      <if test="bizType != null">
        biz_type,
      </if>
      <if test="workItemName != null">
        work_item_name,
      </if>
      <if test="tenderPlanDate != null">
        tender_plan_date,
      </if>
      <if test="latestMarchinDate != null">
        latest_marchin_date,
      </if>
      <if test="tenderWay != null">
        tender_way,
      </if>
      <if test="planSupplierNumber != null">
        plan_supplier_number,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="remark != null">
        remark,
      </if>
      <if test="mainContents != null">
        main_contents,
      </if>
      <if test="scopeWorkload != null">
        scope_workload,
      </if>
      <if test="requirements != null">
        requirements,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="tenderPlanCode != null">
        #{tenderPlanCode,jdbcType=VARCHAR},
      </if>
      <if test="bizType != null">
        #{bizType.enumValue,jdbcType=INTEGER},
      </if>
      <if test="workItemName != null">
        #{workItemName,jdbcType=VARCHAR},
      </if>
      <if test="tenderPlanDate != null">
        #{tenderPlanDate,jdbcType=DATE},
      </if>
      <if test="latestMarchinDate != null">
        #{latestMarchinDate,jdbcType=DATE},
      </if>
      <if test="tenderWay != null">
        #{tenderWay.enumValue,jdbcType=INTEGER},
      </if>
      <if test="planSupplierNumber != null">
        #{planSupplierNumber,jdbcType=INTEGER},
      </if>
      <if test="status != null">
        #{status.enumValue,jdbcType=INTEGER},
      </if>
      <if test="remark != null">
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="mainContents != null">
        #{mainContents,jdbcType=LONGVARCHAR},
      </if>
      <if test="scopeWorkload != null">
        #{scopeWorkload,jdbcType=LONGVARCHAR},
      </if>
      <if test="requirements != null">
        #{requirements,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.banry.pscm.service.tender.TenderPlanWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    update tender_plan
    <set>
      <if test="bizType != null">
        biz_type = #{bizType.enumValue,jdbcType=INTEGER},
      </if>
      <if test="workItemName != null">
        work_item_name = #{workItemName,jdbcType=VARCHAR},
      </if>
      <if test="tenderPlanDate != null">
        tender_plan_date = #{tenderPlanDate,jdbcType=DATE},
      </if>
      <if test="latestMarchinDate != null">
        latest_marchin_date = #{latestMarchinDate,jdbcType=DATE},
      </if>
      <if test="tenderWay != null">
        tender_way = #{tenderWay.enumValue,jdbcType=INTEGER},
      </if>
      <if test="planSupplierNumber != null">
        plan_supplier_number = #{planSupplierNumber,jdbcType=INTEGER},
      </if>
      <if test="status != null">
        status = #{status.enumValue,jdbcType=INTEGER},
      </if>
      <if test="remark != null">
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="mainContents != null">
        main_contents = #{mainContents,jdbcType=LONGVARCHAR},
      </if>
      <if test="scopeWorkload != null">
        scope_workload = #{scopeWorkload,jdbcType=LONGVARCHAR},
      </if>
      <if test="requirements != null">
        requirements = #{requirements,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.banry.pscm.service.tender.TenderPlanWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    update tender_plan
    set biz_type = #{bizType.enumValue,jdbcType=INTEGER},
      work_item_name = #{workItemName,jdbcType=VARCHAR},
      tender_plan_date = #{tenderPlanDate,jdbcType=DATE},
      latest_marchin_date = #{latestMarchinDate,jdbcType=DATE},
      tender_way = #{tenderWay.enumValue,jdbcType=INTEGER},
      plan_supplier_number = #{planSupplierNumber,jdbcType=INTEGER},
      status = #{status.enumValue,jdbcType=INTEGER},
      remark = #{remark,jdbcType=VARCHAR},
      main_contents = #{mainContents,jdbcType=LONGVARCHAR},
      scope_workload = #{scopeWorkload,jdbcType=LONGVARCHAR},
      requirements = #{requirements,jdbcType=LONGVARCHAR}
    where tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.banry.pscm.service.tender.TenderPlan">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 25 16:21:28 CST 2018.
    -->
    update tender_plan
    set biz_type = #{bizType.enumValue,jdbcType=INTEGER},
      work_item_name = #{workItemName,jdbcType=VARCHAR},
      tender_plan_date = #{tenderPlanDate,jdbcType=DATE},
      latest_marchin_date = #{latestMarchinDate,jdbcType=DATE},
      tender_way = #{tenderWay.enumValue,jdbcType=INTEGER},
      plan_supplier_number = #{planSupplierNumber,jdbcType=INTEGER},
      status = #{status.enumValue,jdbcType=INTEGER},
      remark = #{remark,jdbcType=VARCHAR}
    where tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}
  </update>
</mapper>