package com.banry.pscm.persist.mapper;

import org.apache.ibatis.jdbc.SQL;

import com.banry.pscm.service.schedule.SubDivWorkBill;

public class SubDivWorkBillSqlProvider {

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table sub_div_work_bill
     *
     * @mbg.generated Tue Jun 12 14:31:02 CST 2018
     */
    public String insertSelective(SubDivWorkBill record) {
        SQL sql = new SQL();
        sql.INSERT_INTO("sub_div_work_bill");
        
        if (record.getDivisionSnCode() != null) {
            sql.VALUES("division_sn_code", "#{divisionSnCode.divisionSnCode,jdbcType=VARCHAR}");
        }
        
        if (record.getName() != null) {
            sql.VALUES("name", "#{name,jdbcType=VARCHAR}");
        }
        
        if (record.getUnit() != null) {
            sql.VALUES("unit", "#{unit,jdbcType=VARCHAR}");
        }
        
        if (record.getBidMapQuan() != null) {
            sql.VALUES("bid_map_quan", "#{bidMapQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getRawConMapQuan() != null) {
            sql.VALUES("raw_con_map_quan", "#{rawConMapQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getConsMapSumVaryQuan() != null) {
            sql.VALUES("cons_map_sum_vary_quan", "#{consMapSumVaryQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getCalculateUnitPrice() != null) {
            sql.VALUES("calculate_unit_price", "#{calculateUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getContractUnitPrice() != null) {
            sql.VALUES("contract_unit_price", "#{contractUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getCompUnitPrice() != null) {
            sql.VALUES("comp_unit_price", "#{compUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getTemporaryMeasurePrice() != null) {
            sql.VALUES("temporary_measure_price", "#{temporaryMeasurePrice,jdbcType=DOUBLE}");
        }
        
        if (record.getQuotaManualFee() != null) {
            sql.VALUES("quota_manual_fee", "#{quotaManualFee,jdbcType=DOUBLE}");
        }
        
        if (record.getQuotaCode() != null) {
            sql.VALUES("quota_code", "#{quotaCode,jdbcType=VARCHAR}");
        }
        
        if (record.getTenderPlanCode() != null) {
            sql.VALUES("tender_plan_code", "#{tenderPlanCode,jdbcType=VARCHAR}");
        }
        
        if (record.getTenderResultCode() != null) {
            sql.VALUES("tender_result_code", "#{tenderResultCode,jdbcType=VARCHAR}");
        }
        
        if (record.getContractCode() != null) {
            sql.VALUES("contract_code", "#{contractCode,jdbcType=VARCHAR}");
        }
        
        if (record.getCharactDes() != null) {
            sql.VALUES("charact_des", "#{charactDes,jdbcType=LONGVARCHAR}");
        }
        
        return sql.toString();
    }

    /**
     * This method was generated by MyBatis Generator.
     * This method corresponds to the database table sub_div_work_bill
     *
     * @mbg.generated Tue Jun 12 14:31:02 CST 2018
     */
    public String updateByPrimaryKeySelective(SubDivWorkBill record) {
        SQL sql = new SQL();
        sql.UPDATE("sub_div_work_bill");
        
        if (record.getName() != null) {
            sql.SET("name = #{name,jdbcType=VARCHAR}");
        }
        
        if (record.getUnit() != null) {
            sql.SET("unit = #{unit,jdbcType=VARCHAR}");
        }
        
        if (record.getBidMapQuan() != null) {
            sql.SET("bid_map_quan = #{bidMapQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getRawConMapQuan() != null) {
            sql.SET("raw_con_map_quan = #{rawConMapQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getConsMapSumVaryQuan() != null) {
            sql.SET("cons_map_sum_vary_quan = #{consMapSumVaryQuan,jdbcType=DOUBLE}");
        }
        
        if (record.getCalculateUnitPrice() != null) {
            sql.SET("calculate_unit_price = #{calculateUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getContractUnitPrice() != null) {
            sql.SET("contract_unit_price = #{contractUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getCompUnitPrice() != null) {
            sql.SET("comp_unit_price = #{compUnitPrice,jdbcType=DOUBLE}");
        }
        
        if (record.getTemporaryMeasurePrice() != null) {
            sql.SET("temporary_measure_price = #{temporaryMeasurePrice,jdbcType=DOUBLE}");
        }
        
        if (record.getQuotaManualFee() != null) {
            sql.SET("quota_manual_fee = #{quotaManualFee,jdbcType=DOUBLE}");
        }
        
        if (record.getQuotaCode() != null) {
            sql.SET("quota_code = #{quotaCode,jdbcType=VARCHAR}");
        }
        
        if (record.getTenderPlanCode() != null) {
            sql.SET("tender_plan_code = #{tenderPlanCode,jdbcType=VARCHAR}");
        }
        
        if (record.getTenderResultCode() != null) {
            sql.SET("tender_result_code = #{tenderResultCode,jdbcType=VARCHAR}");
        }
        
        if (record.getContractCode() != null) {
            sql.SET("contract_code = #{contractCode,jdbcType=VARCHAR}");
        }
        
        if (record.getCharactDes() != null) {
            sql.SET("charact_des = #{charactDes,jdbcType=LONGVARCHAR}");
        }
        
        sql.WHERE("division_sn_code = #{divisionSnCode.divisionSnCode,jdbcType=VARCHAR}");
        
        return sql.toString();
    }

    public String findWorkBillsByDivisionSnCode(String divisionSnCode) {
        StringBuilder sb = new StringBuilder();
        sb.append("SELECT ");
        sb.append("    a.change_code,");
        sb.append("    a.division_sn_code,");
        sb.append("    'tender_result_change' bill_change_type");
        sb.append("	FROM");
        sb.append("    sub_div_work_tender_result_change_bill a");
        sb.append("	WHERE");
        sb.append("    a.change_type = '1'");
        sb.append("        AND a.division_sn_code = #{divisionSnCode, jdbcType=VARCHAR}");
        sb.append("        AND EXISTS( SELECT ");
        sb.append("            1");
        sb.append("        FROM");
        sb.append("            tender_result_change b");
        sb.append("        WHERE");
        sb.append("            a.change_code = b.tender_result_id_change_code");
        sb.append("                AND b.`status` <> '50'");
        sb.append("                AND b.`status` <> '99') ");
        sb.append("	UNION SELECT ");
        sb.append("    a.change_code,");
        sb.append("    a.division_sn_code,");
        sb.append("    'down_contract_change' bill_change_type");
        sb.append("	FROM");
        sb.append("    sub_div_work_change_bill a");
        sb.append("	WHERE");
        sb.append("    a.change_type = '1'");
        sb.append("        AND a.division_sn_code = #{divisionSnCode, jdbcType=VARCHAR}");
        sb.append("        AND EXISTS( SELECT ");
        sb.append("            1");
        sb.append("        FROM");
        sb.append("            down_contract_change b");
        sb.append("        WHERE");
        sb.append("            a.change_code = b.change_code");
        sb.append("                AND b.`status` <> '50'");
        sb.append("                AND b.`status` <> '99')");
        return sb.toString();
    }
}